# M365 MCP Server - Environment Configuration Example
# Copy this file to .env and fill in your values

# ============================================================================
# REQUIRED - Microsoft Authentication
# ============================================================================

# Azure App Registration Client ID (required)
# Get this from Azure Portal → App Registrations → Your App → Application (client) ID
M365_MCP_CLIENT_ID=your-app-client-id-here

# Azure Tenant ID (optional, defaults to "common")
# Use "common" for multi-tenant (personal + work/school accounts)
# Use "consumers" for personal Microsoft accounts only
# Use your tenant ID for single-tenant (work/school only)
# M365_MCP_TENANT_ID=common

# ============================================================================
# TRANSPORT MODE - Choose stdio (default) or Streamable HTTP
# ============================================================================

# Transport mode: "stdio" or "http"
# - stdio: Default, for desktop apps like Claude Desktop (secure via process isolation)
# - http: Streamable HTTP for web/API access (MCP spec 2025-03-26+, requires authentication)
# MCP_TRANSPORT=stdio

# ============================================================================
# HTTP TRANSPORT CONFIGURATION (only used if MCP_TRANSPORT=http)
# ============================================================================

# HTTP Server Host (default: 127.0.0.1)
# Use 127.0.0.1 for localhost only (recommended)
# Use 0.0.0.0 to bind to all network interfaces (requires firewall configuration)
# MCP_HOST=127.0.0.1

# HTTP Server Port (default: 8000)
# MCP_PORT=8000

# MCP Endpoint Path (default: /mcp)
# The path where the Streamable HTTP endpoint is mounted
# MCP_PATH=/mcp

# ============================================================================
# HTTP AUTHENTICATION (required if MCP_TRANSPORT=http)
# ============================================================================

# Authentication Method: "bearer", "oauth", or "none"
# - bearer: Simple token-based auth (recommended for most use cases)
# - oauth: Enterprise OAuth 2.0 with browser flow (requires FastMCP 2.0+)
# - none: No authentication (DANGEROUS - requires MCP_ALLOW_INSECURE=true)
# MCP_AUTH_METHOD=bearer

# Bearer Token (required if MCP_AUTH_METHOD=bearer)
# Generate a secure token with: openssl rand -hex 32
# Minimum 32 characters recommended
# MCP_AUTH_TOKEN=your-secure-token-here

# Allow Insecure HTTP Server (default: false)
# Set to "true" to allow HTTP without authentication (NOT RECOMMENDED)
# Only use for local development on isolated networks
# WARNING: Anyone who can reach the server will have full access to your Microsoft account!
# MCP_ALLOW_INSECURE=false

# ============================================================================
# EXAMPLE CONFIGURATIONS
# ============================================================================

# Example 1: stdio mode (default) - For Claude Desktop
# M365_MCP_CLIENT_ID=abc123-def456-ghi789
# MCP_TRANSPORT=stdio

# Example 2: Streamable HTTP mode with bearer token authentication
# M365_MCP_CLIENT_ID=abc123-def456-ghi789
# MCP_TRANSPORT=http
# MCP_AUTH_METHOD=bearer
# MCP_AUTH_TOKEN=$(openssl rand -hex 32)
# MCP_HOST=127.0.0.1
# MCP_PORT=8000
# MCP_PATH=/mcp

# Example 3: Streamable HTTP mode with OAuth (FastMCP 2.0+)
# M365_MCP_CLIENT_ID=abc123-def456-ghi789
# MCP_TRANSPORT=http
# MCP_AUTH_METHOD=oauth
# MCP_HOST=127.0.0.1
# MCP_PORT=8000
# MCP_PATH=/mcp

# Example 4: Streamable HTTP mode - Insecure (testing only - NOT RECOMMENDED)
# M365_MCP_CLIENT_ID=abc123-def456-ghi789
# MCP_TRANSPORT=http
# MCP_AUTH_METHOD=none
# MCP_ALLOW_INSECURE=true
# MCP_HOST=127.0.0.1
# MCP_PORT=8000
# MCP_PATH=/mcp

# ============================================================================
# SECURITY NOTES
# ============================================================================
#
# 1. NEVER commit .env file to version control
#    - Add .env to .gitignore (already configured)
#
# 2. Generate secure tokens:
#    - openssl rand -hex 32    # 64-character hex token
#    - python3 -c "import uuid; print(uuid.uuid4())"  # UUID token
#
# 3. Rotate tokens regularly in production
#
# 4. Use secrets managers for production:
#    - AWS Secrets Manager
#    - HashiCorp Vault
#    - Azure Key Vault
#
# 5. For Streamable HTTP mode:
#    - Always use authentication (bearer or oauth)
#    - Prefer localhost binding (127.0.0.1)
#    - Use SSH tunneling for remote access instead of 0.0.0.0
#    - Put behind reverse proxy (nginx/Caddy) for TLS/HTTPS
#
# 6. stdio mode is secure by default (no additional auth needed)
#
# For complete security guide, see SECURITY.md
# For setup instructions, see QUICKSTART.md
